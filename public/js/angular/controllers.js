app.controller('SearchController', [
    '$scope',
    '$timeout',
    'blockUI',
    'Airports',
    'Flights',
    'Hotels',
    'FormValidation',
    function($scope, $timeout, blockUI, Airports, Flights, Hotels, FormValidation) {

    // tab
    $scope.tab = 'flight';

    $scope.selectTab = function(setTab) {
        $scope.tab = setTab;
    }

    $scope.tabSelected = function(checkTab) {
        return $scope.tab === checkTab;
    }

    // bootstrap-switch
    $scope.bs = {};
    $scope.bs.size     = 'small';
    $scope.bs.on       = 'primary';
    $scope.bs.off      = 'primary';

    // ui-datepicker
    $scope.dt = {};
    $scope.dt.format = 'dd-MM-yyyy';
    $scope.dt.minDate = new Date();
    $scope.openDatepicker = function($event, isOpen) {
        $event.preventDefault();
        $event.stopPropagation();
        $scope.dt[isOpen] = true;
    };

    // timepicker
    $scope.hstep = 1;
    $scope.mstep = 30;

    // flight data
    $scope.flight = {};
    $scope.flight.type = 'OW';
    $scope.flight.priority = 'price';

    var defaultTime = new Date().setHours(0);
    var defaultTime = new Date(defaultTime).setMinutes(0);
    var defaultTime = new Date(defaultTime);
    $scope.flight.departTime = defaultTime;
    $scope.flight.returnTime = defaultTime;

    var saveTimeout;
    var airportCoordinates;
    $scope.airports = function(val) {
        return Airports(val).then(function(response) {
          return response.data.map(function(item) {
            airportCoordinates  = item.latitude + ',' + item.longitude;
            var code = item.iata === '' ? item.icao : item.iata;
            return item.name + ', ' + item.city + ' (' + code + ')';
          });
        });
    }

    $scope.hotel = {};
    $scope.hotel.priority = 'price';
    $scope.hotel.facilities = {};
    $scope.hotel.facilities.wifi = false;
    $scope.hotel.facilities.ac   = false;
    $scope.hotel.facilities.hw   = false;
    $scope.hotel.facilities.tv   = false;
    $scope.hotel.facilities.safe = false;

    // rating
    $scope.rate = 1;
    $scope.max = 5;
    $scope.titles = [1,2,3,4,5];

    // synchronize data
    $scope.$watch('flight.departDate', function() {
        // synchronize data between depart date and return date
        $scope.dt.minRetDate = $scope.flight.departDate;

        // synchronize data between flight and hotel
        $scope.hotel.checkIn = $scope.flight.departDate;
    });

    $scope.$watch('flight.returnDate', function() {
        $scope.hotel.checkOut = $scope.flight.returnDate;
    });

    // submit
    $scope.submit = function() {

        FormValidation($scope.flight, $scope.hotel);

        // preprocessing data
        if ($scope.hotel.keyword === undefined) {
            $scope.hotel.airport = $scope.flight.destination;
        }

        $scope.hotel.adults              = $scope.flight.adults;
        $scope.hotel.children            = $scope.flight.children;
        $scope.flight.airportCoordinates = airportCoordinates;
        $scope.hotel.airportCoordinates  = airportCoordinates;

        // start searching
        $scope.$parent.$broadcast('start');

        var blockSearchWidget = blockUI.instances.get('searchWidget');
        blockSearchWidget.start();

        Flights($scope.flight).then(function(response) {
            $scope.flight.done = true;

            if ($scope.hotel.done === true && $scope.flight.done === true) {
                blockSearchWidget.stop();
            }

            $scope.$parent.$broadcast('flightDone', response);
        });

        Hotels($scope.hotel).then(function(response) {
            $scope.hotel.done = true;

            if ($scope.hotel.done === true && $scope.flight.done === true) {
                blockSearchWidget.stop();
            }

            $scope.$parent.$broadcast('hotelDone', response);
        });
    }

}]);

app.controller('MainController', ['Venues', '$scope', function(Venues, $scope) {

    // $scope.fw = {};
    // $scope.hw = {};
    // $scope.vw = {};
    // var flightdata = '{"request":{"adults":"1","airportCoordinates":"-8.748169,115.167172","children":"0","departDate":"20-10-2015","departTime":"00:00","destination":"Bali Ngurah Rai, Denpasar (DPS)","infants":"0","origin":"Soekarno Hatta Intl, Jakarta (CGK)","priority":"price","returnDate":"22-10-2015","returnTime":"00:00","type":"RT"},"response":{"all_flights":{"departure":[{"airline_name":"SRIWIJAYA","flight_number":"SJ-272","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_sriwijaya_2.jpg","depart_time":"05:45","arrival_time":"08:35","price":{"promo":1,"adults":"579600.00","children":"0.00","infants":"0.00","total":"579600.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"SJ-272","departure_city":"CGK","arrival_city":"DPS","depart_time":"05:45","arrival_time":"08:35"}],"duration":"1 h 50 m"}},{"airline_name":"SRIWIJAYA","flight_number":"SJ-260","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_sriwijaya_2.jpg","depart_time":"15:10","arrival_time":"18:00","price":{"promo":0,"adults":"837000.00","children":"0.00","infants":"0.00","total":"837000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"SJ-260","departure_city":"CGK","arrival_city":"DPS","depart_time":"15:10","arrival_time":"18:00"}],"duration":"1 h 50 m"}},{"airline_name":"CITILINK","flight_number":"QG-850","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"07:40","arrival_time":"10:25","price":{"promo":0,"adults":"924368.00","children":"0.00","infants":"0.00","total":"924368.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-850","departure_city":"CGK","arrival_city":"DPS","depart_time":"07:40","arrival_time":"10:25"}],"duration":"1 h 45 m"}},{"airline_name":"CITILINK","flight_number":"QG-854","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"11:20","arrival_time":"14:05","price":{"promo":0,"adults":"692350.00","children":"0.00","infants":"0.00","total":"692350.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-854","departure_city":"CGK","arrival_city":"DPS","depart_time":"11:20","arrival_time":"14:05"}],"duration":"1 h 45 m"}},{"airline_name":"CITILINK","flight_number":"QG-9743","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"13:10","arrival_time":"15:55","price":{"promo":0,"adults":"924368.00","children":"0.00","infants":"0.00","total":"924368.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-9743","departure_city":"CGK","arrival_city":"DPS","depart_time":"13:10","arrival_time":"15:55"}],"duration":"1 h 45 m"}},{"airline_name":"CITILINK","flight_number":"QG-852","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"16:40","arrival_time":"19:30","price":{"promo":0,"adults":"622500.00","children":"0.00","infants":"0.00","total":"622500.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-852","departure_city":"CGK","arrival_city":"DPS","depart_time":"16:40","arrival_time":"19:30"}],"duration":"1 h 50 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7514","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"15:10","arrival_time":"17:55","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7514","departure_city":"CGK","arrival_city":"DPS","depart_time":"15:10","arrival_time":"17:55"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7516","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"19:35","arrival_time":"22:25","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7516","departure_city":"CGK","arrival_city":"DPS","depart_time":"19:35","arrival_time":"22:25"}],"duration":"1 h 50 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7510","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"06:00","arrival_time":"08:50","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7510","departure_city":"CGK","arrival_city":"DPS","depart_time":"06:00","arrival_time":"08:50"}],"duration":"1 h 50 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7520","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"09:55","arrival_time":"12:30","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7520","departure_city":"CGK","arrival_city":"DPS","depart_time":"09:55","arrival_time":"12:30"}],"duration":"1 h 35 m"}},{"airline_name":"AIRASIA","flight_number":"XT-7534","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"21:40","arrival_time":"00:25","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"XT-7534","departure_city":"CGK","arrival_city":"DPS","depart_time":"21:40","arrival_time":"00:25"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"XT-7532","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"13:40","arrival_time":"16:25","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"XT-7532","departure_city":"CGK","arrival_city":"DPS","depart_time":"13:40","arrival_time":"16:25"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"XT-7518","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"18:15","arrival_time":"21:00","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"XT-7518","departure_city":"CGK","arrival_city":"DPS","depart_time":"18:15","arrival_time":"21:00"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"XT-7526","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"08:40","arrival_time":"11:35","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"XT-7526","departure_city":"CGK","arrival_city":"DPS","depart_time":"08:40","arrival_time":"11:35"}],"duration":"1 h 55 m"}}],"return":[{"airline_name":"CITILINK","flight_number":"QG-855","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"16:00","arrival_time":"16:45","price":{"promo":0,"adults":"787850.00","children":"0.00","infants":"0.00","total":"787850.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-855","departure_city":"DPS","arrival_city":"CGK","depart_time":"16:00","arrival_time":"16:45"}],"duration":"1 h 45 m"}},{"airline_name":"CITILINK","flight_number":"QG-9744","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"16:35","arrival_time":"17:20","price":{"promo":0,"adults":"787850.00","children":"0.00","infants":"0.00","total":"787850.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-9744","departure_city":"DPS","arrival_city":"CGK","depart_time":"16:35","arrival_time":"17:20"}],"duration":"1 h 45 m"}},{"airline_name":"CITILINK","flight_number":"QG-853","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"20:05","arrival_time":"20:50","price":{"promo":0,"adults":"787850.00","children":"0.00","infants":"0.00","total":"787850.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-853","departure_city":"DPS","arrival_city":"CGK","depart_time":"20:05","arrival_time":"20:50"}],"duration":"1 h 45 m"}},{"airline_name":"CITILINK","flight_number":"QG-851","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"20:30","arrival_time":"21:15","price":{"promo":0,"adults":"890398.00","children":"0.00","infants":"0.00","total":"890398.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-851","departure_city":"DPS","arrival_city":"CGK","depart_time":"20:30","arrival_time":"21:15"}],"duration":"1 h 45 m"}},{"airline_name":"SRIWIJAYA","flight_number":"SJ-273","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_sriwijaya_2.jpg","depart_time":"16:50","arrival_time":"17:30","price":{"promo":0,"adults":"652000.00","children":"0.00","infants":"0.00","total":"652000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"SJ-273","departure_city":"DPS","arrival_city":"CGK","depart_time":"16:50","arrival_time":"17:30"}],"duration":"1 h 40 m"}},{"airline_name":"SRIWIJAYA","flight_number":"SJ-261","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_sriwijaya_2.jpg","depart_time":"18:35","arrival_time":"19:15","price":{"promo":0,"adults":"614600.00","children":"0.00","infants":"0.00","total":"614600.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"SJ-261","departure_city":"DPS","arrival_city":"CGK","depart_time":"18:35","arrival_time":"19:15"}],"duration":"1 h 40 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7515","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"18:20","arrival_time":"19:05","price":{"promo":1,"adults":"584620.00","children":"0.00","infants":"0.00","total":"584620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7515","departure_city":"DPS","arrival_city":"CGK","depart_time":"18:20","arrival_time":"19:05"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7517","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"22:55","arrival_time":"23:30","price":{"promo":1,"adults":"584620.00","children":"0.00","infants":"0.00","total":"584620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7517","departure_city":"DPS","arrival_city":"CGK","depart_time":"22:55","arrival_time":"23:30"}],"duration":"1 h 35 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7511","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"09:20","arrival_time":"09:55","price":{"promo":1,"adults":"584620.00","children":"0.00","infants":"0.00","total":"584620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7511","departure_city":"DPS","arrival_city":"CGK","depart_time":"09:20","arrival_time":"09:55"}],"duration":"1 h 35 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7521","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"13:15","arrival_time":"14:10","price":{"promo":1,"adults":"584620.00","children":"0.00","infants":"0.00","total":"584620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7521","departure_city":"DPS","arrival_city":"CGK","depart_time":"13:15","arrival_time":"14:10"}],"duration":"1 h 55 m"}},{"airline_name":"AIRASIA","flight_number":"XT-7533","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"20:30","arrival_time":"21:15","price":{"promo":1,"adults":"584620.00","children":"0.00","infants":"0.00","total":"584620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"XT-7533","departure_city":"DPS","arrival_city":"CGK","depart_time":"20:30","arrival_time":"21:15"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"XT-7531","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"12:30","arrival_time":"13:15","price":{"promo":1,"adults":"584620.00","children":"0.00","infants":"0.00","total":"584620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"XT-7531","departure_city":"DPS","arrival_city":"CGK","depart_time":"12:30","arrival_time":"13:15"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"XT-7519","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"21:25","arrival_time":"22:10","price":{"promo":1,"adults":"584620.00","children":"0.00","infants":"0.00","total":"584620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"XT-7519","departure_city":"DPS","arrival_city":"CGK","depart_time":"21:25","arrival_time":"22:10"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"XT-7527","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"12:00","arrival_time":"12:45","price":{"promo":1,"adults":"584620.00","children":"0.00","infants":"0.00","total":"584620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"XT-7527","departure_city":"DPS","arrival_city":"CGK","depart_time":"12:00","arrival_time":"12:45"}],"duration":"1 h 45 m"}}]},"rec_flight":{"departure":{"airline_name":"SRIWIJAYA","flight_number":"SJ-272","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_sriwijaya_2.jpg","depart_time":"05:45","arrival_time":"08:35","price":{"promo":1,"adults":"579600.00","children":"0.00","infants":"0.00","total":"579600.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"SJ-272","departure_city":"CGK","arrival_city":"DPS","depart_time":"05:45","arrival_time":"08:35"}],"duration":"1 h 50 m"}},"return":{"airline_name":"CITILINK","flight_number":"QG-855","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"16:00","arrival_time":"16:45","price":{"promo":0,"adults":"787850.00","children":"0.00","infants":"0.00","total":"787850.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-855","departure_city":"DPS","arrival_city":"CGK","depart_time":"16:00","arrival_time":"16:45"}],"duration":"1 h 45 m"}}}}}';
    // var flightdata = '{"request":{"adults":"1","airportCoordinates":"-8.748169,115.167172","children":"0","departDate":"26-10-2015","departTime":"00:00","destination":"Bali Ngurah Rai, Denpasar (DPS)","infants":"0","origin":"Soekarno Hatta Intl, Jakarta (CGK)","priority":"price","returnTime":"00:00","type":"OW"},"response":{"all_flights":{"departure":[{"airline_name":"CITILINK","flight_number":"QG-850","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"07:40","arrival_time":"10:25","price":{"promo":0,"adults":"684573.00","children":"0.00","infants":"0.00","total":"684573.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-850","departure_city":"CGK","arrival_city":"DPS","depart_time":"07:40","arrival_time":"10:25"}],"duration":"1 h 45 m"}},{"airline_name":"CITILINK","flight_number":"QG-854","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"11:20","arrival_time":"14:05","price":{"promo":0,"adults":"614723.00","children":"0.00","infants":"0.00","total":"614723.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-854","departure_city":"CGK","arrival_city":"DPS","depart_time":"11:20","arrival_time":"14:05"}],"duration":"1 h 45 m"}},{"airline_name":"CITILINK","flight_number":"QG-9743","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"13:10","arrival_time":"15:55","price":{"promo":0,"adults":"614723.00","children":"0.00","infants":"0.00","total":"614723.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-9743","departure_city":"CGK","arrival_city":"DPS","depart_time":"13:10","arrival_time":"15:55"}],"duration":"1 h 45 m"}},{"airline_name":"CITILINK","flight_number":"QG-852","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"16:40","arrival_time":"19:30","price":{"promo":0,"adults":"614723.00","children":"0.00","infants":"0.00","total":"614723.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-852","departure_city":"CGK","arrival_city":"DPS","depart_time":"16:40","arrival_time":"19:30"}],"duration":"1 h 50 m"}},{"airline_name":"SRIWIJAYA","flight_number":"SJ-272","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_sriwijaya_2.jpg","depart_time":"05:45","arrival_time":"08:35","price":{"promo":0,"adults":"617000.00","children":"0.00","infants":"0.00","total":"617000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"SJ-272","departure_city":"CGK","arrival_city":"DPS","depart_time":"05:45","arrival_time":"08:35"}],"duration":"1 h 50 m"}},{"airline_name":"SRIWIJAYA","flight_number":"SJ-260","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_sriwijaya_2.jpg","depart_time":"15:10","arrival_time":"18:00","price":{"promo":0,"adults":"579600.00","children":"0.00","infants":"0.00","total":"579600.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"SJ-260","departure_city":"CGK","arrival_city":"DPS","depart_time":"15:10","arrival_time":"18:00"}],"duration":"1 h 50 m"}},{"airline_name":"GARUDA","flight_number":"GA-400","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"05:40","arrival_time":"08:35","price":{"promo":0,"adults":"1409000.00","children":"0.00","infants":"0.00","total":"1409000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-400","departure_city":"CGK","arrival_city":"DPS","depart_time":"05:40","arrival_time":"08:35"}],"duration":"1 h 55 m"}},{"airline_name":"GARUDA","flight_number":"GA-438","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"07:15","arrival_time":"10:10","price":{"promo":1,"adults":"980000.00","children":"0.00","infants":"0.00","total":"980000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-438","departure_city":"CGK","arrival_city":"DPS","depart_time":"07:15","arrival_time":"10:10"}],"duration":"1 h 55 m"}},{"airline_name":"GARUDA","flight_number":"GA-402","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"07:50","arrival_time":"10:50","price":{"promo":1,"adults":"870000.00","children":"0.00","infants":"0.00","total":"870000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-402","departure_city":"CGK","arrival_city":"DPS","depart_time":"07:50","arrival_time":"10:50"}],"duration":"2 h 0 m"}},{"airline_name":"GARUDA","flight_number":"GA-404","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"09:35","arrival_time":"12:35","price":{"promo":0,"adults":"2023900.00","children":"0.00","infants":"0.00","total":"2023900.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-404","departure_city":"CGK","arrival_city":"DPS","depart_time":"09:35","arrival_time":"12:35"}],"duration":"2 h 0 m"}},{"airline_name":"GARUDA","flight_number":"GA-408","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"11:35","arrival_time":"14:40","price":{"promo":0,"adults":"1409000.00","children":"0.00","infants":"0.00","total":"1409000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-408","departure_city":"CGK","arrival_city":"DPS","depart_time":"11:35","arrival_time":"14:40"}],"duration":"2 h 5 m"}},{"airline_name":"GARUDA","flight_number":"GA-422","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"13:10","arrival_time":"16:10","price":{"promo":0,"adults":"1563000.00","children":"0.00","infants":"0.00","total":"1563000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-422","departure_city":"CGK","arrival_city":"DPS","depart_time":"13:10","arrival_time":"16:10"}],"duration":"2 h 0 m"}},{"airline_name":"GARUDA","flight_number":"GA-410","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"14:15","arrival_time":"17:20","price":{"promo":1,"adults":"870000.00","children":"0.00","infants":"0.00","total":"870000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-410","departure_city":"CGK","arrival_city":"DPS","depart_time":"14:15","arrival_time":"17:20"}],"duration":"2 h 5 m"}},{"airline_name":"GARUDA","flight_number":"GA-414","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"14:55","arrival_time":"18:00","price":{"promo":1,"adults":"870000.00","children":"0.00","infants":"0.00","total":"870000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-414","departure_city":"CGK","arrival_city":"DPS","depart_time":"14:55","arrival_time":"18:00"}],"duration":"2 h 5 m"}},{"airline_name":"GARUDA","flight_number":"GA-420","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"16:30","arrival_time":"19:25","price":{"promo":1,"adults":"980000.00","children":"0.00","infants":"0.00","total":"980000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-420","departure_city":"CGK","arrival_city":"DPS","depart_time":"16:30","arrival_time":"19:25"}],"duration":"1 h 55 m"}},{"airline_name":"GARUDA","flight_number":"GA-426","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"17:05","arrival_time":"20:10","price":{"promo":1,"adults":"870000.00","children":"0.00","infants":"0.00","total":"870000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-426","departure_city":"CGK","arrival_city":"DPS","depart_time":"17:05","arrival_time":"20:10"}],"duration":"2 h 5 m"}},{"airline_name":"GARUDA","flight_number":"GA-418","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"18:30","arrival_time":"21:30","price":{"promo":0,"adults":"1310000.00","children":"0.00","infants":"0.00","total":"1310000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-418","departure_city":"CGK","arrival_city":"DPS","depart_time":"18:30","arrival_time":"21:30"}],"duration":"2 h 0 m"}},{"airline_name":"GARUDA","flight_number":"GA-412","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"20:00","arrival_time":"22:55","price":{"promo":1,"adults":"870000.00","children":"0.00","infants":"0.00","total":"870000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-412","departure_city":"CGK","arrival_city":"DPS","depart_time":"20:00","arrival_time":"22:55"}],"duration":"1 h 55 m"}},{"airline_name":"GARUDA","flight_number":"GA-424","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"21:15","arrival_time":"00:15","price":{"promo":1,"adults":"870000.00","children":"0.00","infants":"0.00","total":"870000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-424","departure_city":"CGK","arrival_city":"DPS","depart_time":"21:15","arrival_time":"00:15"}],"duration":"2 h 0 m"}},{"airline_name":"GARUDA","flight_number":"GA-652","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_garuda_2.jpg","depart_time":"22:00","arrival_time":"01:00","price":{"promo":1,"adults":"870000.00","children":"0.00","infants":"0.00","total":"870000.00"},"facilities":{"food":"1","baggage":"20","airport_tax":true},"flight_info":{"routes":[{"flight_number":"GA-652","departure_city":"CGK","arrival_city":"DPS","depart_time":"22:00","arrival_time":"01:00"}],"duration":"2 h 0 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7518","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"18:15","arrival_time":"21:05","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7518","departure_city":"CGK","arrival_city":"DPS","depart_time":"18:15","arrival_time":"21:05"}],"duration":"1 h 50 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7514","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"15:10","arrival_time":"17:55","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7514","departure_city":"CGK","arrival_city":"DPS","depart_time":"15:10","arrival_time":"17:55"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"XT-7534","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"21:40","arrival_time":"00:25","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"XT-7534","departure_city":"CGK","arrival_city":"DPS","depart_time":"21:40","arrival_time":"00:25"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7516","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"19:35","arrival_time":"22:25","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7516","departure_city":"CGK","arrival_city":"DPS","depart_time":"19:35","arrival_time":"22:25"}],"duration":"1 h 50 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7526","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"08:25","arrival_time":"11:20","price":{"promo":0,"adults":"615900.00","children":"0.00","infants":"0.00","total":"615900.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7526","departure_city":"CGK","arrival_city":"DPS","depart_time":"08:25","arrival_time":"11:20"}],"duration":"1 h 55 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7510","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"06:00","arrival_time":"08:50","price":{"promo":0,"adults":"615900.00","children":"0.00","infants":"0.00","total":"615900.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7510","departure_city":"CGK","arrival_city":"DPS","depart_time":"06:00","arrival_time":"08:50"}],"duration":"1 h 50 m"}},{"airline_name":"AIRASIA","flight_number":"XT-7532","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"13:40","arrival_time":"16:25","price":{"promo":1,"adults":"549620.00","children":"0.00","infants":"0.00","total":"549620.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"XT-7532","departure_city":"CGK","arrival_city":"DPS","depart_time":"13:40","arrival_time":"16:25"}],"duration":"1 h 45 m"}},{"airline_name":"AIRASIA","flight_number":"QZ-7520","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_airasia_2.jpg","depart_time":"09:55","arrival_time":"12:35","price":{"promo":0,"adults":"615900.00","children":"0.00","infants":"0.00","total":"615900.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QZ-7520","departure_city":"CGK","arrival_city":"DPS","depart_time":"09:55","arrival_time":"12:35"}],"duration":"1 h 40 m"}}],"return":[]},"rec_flight":{"departure":{"airline_name":"CITILINK","flight_number":"QG-850","image":"https:\/\/api-sandbox.tiket.com\/images\/tiket2\/icon_citilink_2.jpg","depart_time":"07:40","arrival_time":"10:25","price":{"promo":0,"adults":"684573.00","children":"0.00","infants":"0.00","total":"684573.00"},"facilities":{"food":"0","baggage":"15","airport_tax":true},"flight_info":{"routes":[{"flight_number":"QG-850","departure_city":"CGK","arrival_city":"DPS","depart_time":"07:40","arrival_time":"10:25"}],"duration":"1 h 45 m"}},"return":[]}}}';
    // $scope.fw.data = JSON.parse(flightdata);
    // $scope.fw.show = true;
    // $scope.fw.done = true;
    // var hoteldata = '{"request":{"adults":"1","airport":"Adi Sutjipto, Yogyakarta (JOG)","airportCoordinates":"-7.788181,110.431758","checkIn":"15-10-2015","checkOut":"16-10-2015","children":"0","facilities":{"wifi":false,"ac":false,"hw":false,"tv":false,"safe":false},"keyword":"Yogyakarta","priority":"price","rating":"5","rooms":"1"},"response":{"all_hotels":[{"name":"Grand Zuri Malioboro Yogyakarta","room_available":"6","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/g\/r\/business-grandzurimalioboro_building_13294.sq2.jpg","max_occupancies":"2","address":"Jln. Mangkubumi no 18, Malioboro , Danurejan, Yogyakarta","regional":"Danurejan - Danurejan - Daerah Istimewa Yogyakarta","facilities":["Non Smoking room subject to availability","In room safe","Air conditioning","Satellite\/cable TV","Desk","Shower","Mini bar","Coffee\/tea maker","Complimentary bottled water","Slipper","Mirror","Refrigerator","Free Toiletries","Cupboard","Hot and Cold Shower","Electronic\/magnetic Keys ","Free Wired High-speed Internet ","Climate Control ","Direct-dial Phone ","Minibar ","LCD TV "],"price":{"old":"1108155.00","current":"589558.00","total":"589558.00"},"distance":"8.4 km","duration":"22 mins","coordinates":"-7.78865048375879600000,110.36666017753305000000"},{"name":"Merapi Merbabu Hotels &amp; Resorts Yogyakarta","room_available":"3","rating":"4","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/m\/m\/business-mm-hotel-room.sq2.jpg","max_occupancies":"2","address":"Seturan Main Street, Depok, Sleman","regional":"Condong Catur - Depok - Daerah Istimewa Yogyakarta","facilities":["Air conditioning","Internet - Wifi (complimentary)","Television LCD\/plasma screen","Satellite\/cable TV","Desk","Shower","Coffee\/tea maker","Complimentary bottled water","Daily newspaper","Television","Telephone","Slipper","Mirror","Hair dryer on request","Refrigerator","Free Toiletries","Sofa Bed"],"price":{"old":"1078242.00","current":"651300.00","total":"651300.00"},"distance":"6.3 km","duration":"12 mins","coordinates":"-7.76510059999999900000,110.41087279999999000000"},{"name":"Mutiara Malioboro Hotel","room_available":"3","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/p\/o\/business-pool9.sq2.jpg","max_occupancies":"2","address":"Jalan Malioboro 18, Danurejan, Yogyakarta","regional":"Danurejan - Danurejan - Daerah Istimewa Yogyakarta","facilities":["Air conditioning","Internet - Wifi (complimentary)","Satellite\/cable TV","Desk","Shower","Bathtub","Mini bar","Coffee\/tea maker","Complimentary bottled water","Television","Telephone","Mirror","Free Toiletries","Cupboard","Hot and Cold Shower"],"price":{"old":"1142589.00","current":"730000.00","total":"730000.00"},"distance":"9.1 km","duration":"24 mins","coordinates":"-7.79446627392836260000,110.36574899814764000000"},{"name":"","room_available":"2","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/default\/d\/e\/default-default.sq2.jpg","max_occupancies":"1","address":"","regional":"  -   - Jawa Tengah","facilities":[""],"price":{"old":"1420410.00","current":"","total":"1420410.00"},"distance":"48.5 km","duration":"1 hour 18 mins","coordinates":"-7.49732330000000000000,110.21053259999996000000"},{"name":"Inna Garuda Hotel, Convention &amp; Business","room_available":"5","rating":"4","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/i\/n\/business-inne.sq2.jpg","max_occupancies":"2","address":"Jl. Malioboro 60, Wirobrajan, Yogyakarta","regional":"  - Wirobrajan - Daerah Istimewa Yogyakarta","facilities":["Air conditioning","Internet - Wifi (complimentary)","Satellite\/cable TV","Shower","Bathtub","Mini bar","Coffee\/tea maker","Complimentary bottled water","Television","Telephone","Slipper","Mirror","Refrigerator","Free Toiletries"],"price":{"old":"1135653.00","current":"797500.00","total":"797500.00"},"distance":"8.6 km","duration":"22 mins","coordinates":"-7.79059704097567700000,110.36646783016363000000"},{"name":"Queen of The South Beach Resort","room_available":"2","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/i\/m\/business-img_3091.sq2.jpg","max_occupancies":"2","address":"Parangtritis, Kretek-Bantul, Kretek, Bantul","regional":"  - Kretek - Daerah Istimewa Yogyakarta","facilities":["Air conditioning","Satellite\/cable TV","Bathtub","Complimentary bottled water","Television","Telephone","Mirror","Hair dryer on request","Balcony","Terrace","Free Toiletries","Coffee and Tea Maker on request","Cupboard","Hot and Cold Shower"],"price":{"old":"1252152.00","current":"800000.00","total":"800000.00"},"distance":"8.9 km","duration":"25 mins","coordinates":"-7.79722400000000000000,110.36879699999997000000"},{"name":"The Victoria Hotel Yogyakarta","room_available":"3","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/v\/i\/business-victoria-yogya-pool.sq2.jpg","max_occupancies":"2","address":"Jl. Laksda Adisutjipto Km. 5 , Mantrijeron, Yogyakarta","regional":"Suryodiningratan - Mantrijeron - Daerah Istimewa Yogyakarta","facilities":["Air conditioning","Internet - Wifi","Television LCD\/plasma screen","Satellite\/cable TV","Desk","Shower","Mini bar","Coffee\/tea maker","Complimentary bottled water"],"price":{"old":"1408671.00","current":"850000.00","total":"850000.00"},"distance":"5.0 km","duration":"11 mins","coordinates":"-7.78319030000000000000,110.40225609999993000000"},{"name":"Santika Premiere Jogja","room_available":"4","rating":"4","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/0\/6\/business-06-12-2011-10-40-44.sq2.jpg","max_occupancies":"2","address":"Jl. Jend. Sudirman No.19, Yogyakarta","regional":"  -   - Daerah Istimewa Yogyakarta","facilities":["In room safe","Air conditioning","Internet - Wifi (complimentary)","Television LCD\/plasma screen","Satellite\/cable TV","Desk","Shower","Bathrobes","Bathtub","Mini bar","Coffee\/tea maker","Complimentary bottled water","Daily newspaper"],"price":{"old":"1246014.00","current":"","total":"1246014.00"},"distance":"7.5 km","duration":"19 mins","coordinates":"-7.78280935990782700000,110.36955231796878000000"},{"name":"Poeri Devata Resort Hotel","room_available":"5","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/f\/r\/business-front-hotel_L.sq2.jpg","max_occupancies":"2","address":"Klurak - Taman Martani - Prambanan- Kalasan - Sleman, Kalasan, Sleman","regional":"Taman Martani - Kalasan - Daerah Istimewa Yogyakarta","facilities":["Air conditioning","Internet - Wifi (complimentary)","Satellite\/cable TV","Shower","Bathtub","Coffee\/tea maker","Complimentary bottled water","Television"],"price":{"old":"1173893.00","current":"877680.00","total":"877680.00"},"distance":"8.0 km","duration":"15 mins","coordinates":"-7.75145441399123850000,110.48704727906807000000"},{"name":"Grand Quality Hotel Yogyakarta","room_available":"10","rating":"4","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/d\/l\/business-dlx213.sq2.jpg","max_occupancies":"2","address":"Jl. Laksda Adisucipto No. 48, Wirobrajan, Yogyakarta","regional":"Pakuncen - Wirobrajan - Daerah Istimewa Yogyakarta","facilities":["Non Smoking room subject to availability","In room safe","Air conditioning","Internet access \u2013 LAN (complimentary)","Internet - Wifi (complimentary)","Television LCD\/plasma screen","Satellite\/cable TV","Shower","Bathrobes","Bathtub","Hair dryer","Mini bar","Coffee\/tea maker","Complimentary bottled water","Daily newspaper","Television","Telephone","Slipper","Iron board on request","Hair dryer on request","Refrigerator"],"price":{"old":"1085198.00","current":"880000.00","total":"880000.00"},"distance":"2.7 km","duration":"6 mins","coordinates":"-7.78335659999999900000,110.42349509999997000000"},{"name":"Jogjakarta Plaza Hotel","room_available":"5","rating":"4","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/s\/w\/business-swimming_pool85.sq2.jpg","max_occupancies":"2","address":"Jl. Affandi, Gejayan, Complex Colombo, Depok, Sleman","regional":"Catur Tunggal - Depok - Daerah Istimewa Yogyakarta","facilities":["In room safe","Air conditioning","Internet - Wifi","Television LCD\/plasma screen","Satellite\/cable TV","Desk","Shower","Mini bar","Coffee\/tea maker","Complimentary bottled water","Television","Telephone","Slipper","Free Toiletries","Cupboard","Hot and Cold Shower"],"price":{"old":"1220500.00","current":"887600.00","total":"887600.00"},"distance":"5.9 km","duration":"14 mins","coordinates":"-7.77997499999999900000,110.38818000000003000000"},{"name":"The Grand Palace Hotel","room_available":"1","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/default\/d\/e\/default-default.sq2.jpg","max_occupancies":"2","address":"Mangkuyudan no.32, Yogyakarta","regional":"  -   - Daerah Istimewa Yogyakarta","facilities":[""],"price":{"old":"2817342.00","current":"","total":"2817342.00"},"distance":"14.3 km","duration":"27 mins","coordinates":"-7.82157730000000000000,110.36545849999993000000"},{"name":"Hotel Tentrem Yogyakarta","room_available":"3","rating":"5","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/h\/o\/business-hoteltentrem_guest_r1.sq2.jpg","max_occupancies":"2","address":"Jl. AM Sangaji No. 72 A Yogyakarta 55233, Jetis, Yogyakarta","regional":"Bumijo - Jetis - Daerah Istimewa Yogyakarta","facilities":["In room safe","Air conditioning","Television LCD\/plasma screen","Desk","Shower","Bathtub","Hair dryer","Coffee\/tea maker","Complimentary bottled water","Television","Telephone","Free Toiletries","Cupboard","Hot and Cold Shower","Satellite TV Service ","LCD TV ","Free Wi-Fi ","Cable TV Service ","Minibar "],"price":{"old":"0.00","current":"","total":"0.00"},"distance":"8.5 km","duration":"23 mins","coordinates":"-7.77713830000000000000,110.36772680000001000000"},{"name":"Hotel Indah Palace Yogyakarta","room_available":"2","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/h\/i\/business-hip_main.sq2.jpg","max_occupancies":"2","address":"Jl. Sisingamangaraja 74, Prawirotaman Area, Yogyakarta","regional":"  -   - Daerah Istimewa Yogyakarta","facilities":["In room safe","Air conditioning","Internet - Wifi (complimentary)","Satellite\/cable TV","Desk","Shower","Bathtub","Mini bar","Coffee\/tea maker","Complimentary bottled water","Television","Telephone","Slipper","Mirror","Refrigerator","Terrace","Free Toiletries","Hot and Cold Shower"],"price":{"old":"950853.00","current":"607500.00","total":"607500.00"},"distance":"13.5 km","duration":"24 mins","coordinates":"-7.81906433904530800000,110.37300218280336000000"},{"name":"The Oxalis Regency Hotel","room_available":"4","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/l\/_\/business-l_37457-1-the-oxalis-regency-hotel.sq2.jpg","max_occupancies":"2","address":"Cempaka Street  No 15, Magelang Tengah, Magelang","regional":"Kemirirejo - Magelang Tengah - Jawa Tengah","facilities":["Air conditioning","Internet - Wifi (complimentary)","Satellite\/cable TV","Shower","Bathtub","Mini bar","Coffee\/tea maker","Complimentary bottled water","Television"],"price":{"old":"959070.00","current":"612750.00","total":"612750.00"},"distance":"49.0 km","duration":"1 hour 20 mins","coordinates":"-7.48025839196049800000,110.21595013162994000000"},{"name":"Gallery Prawirotaman Hotel","room_available":"10","rating":"4","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/c\/p\/business-cpc_0008.sq2.jpg","max_occupancies":"2","address":"Jl. Prawirotaman 2 (Jl. Grilya) 839B, Mergangsan, Yogyakarta","regional":"Brontokusuman - Mergangsan - Daerah Istimewa Yogyakarta","facilities":["Non Smoking room subject to availability","In room safe","Air conditioning","Internet - Wifi","Internet - Wifi (complimentary)","Television LCD\/plasma screen","Satellite\/cable TV","Desk","Shower","Mini bar","Coffee\/tea maker","Complimentary bottled water","Television","Telephone","Slipper","Mirror","Iron board on request","Hair dryer on request","Sundeck","Balcony","Cupboard","Hot and Cold Shower"],"price":{"old":"904332.00","current":"800000.00","total":"800000.00"},"distance":"8.9 km","duration":"25 mins","coordinates":"-7.79747180000000000000,110.36863160000007000000"},{"name":"Crystal Lotus Hotel Yogyakarta Managed By Prabu","room_available":"9","rating":"4","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/c\/r\/business-crystal-lotus-exterior1.sq2.jpg","max_occupancies":"2","address":"Magelang Street KM.  5,2 Yogyakarta, Sleman, Sleman","regional":"  - Sleman - Daerah Istimewa Yogyakarta","facilities":["Non Smoking room subject to availability","In room safe","Air conditioning","Internet - Wifi","Internet - Wifi (complimentary)","Television LCD\/plasma screen","Satellite\/cable TV","Desk","Shower","Bathrobes","Bathtub","Hair dryer","Mini bar","Coffee\/tea maker","Complimentary bottled water","Television","Telephone","Slipper","Mirror","Iron board on request","Refrigerator","Balcony","Free Toiletries","Hot and Cold Shower"],"price":{"old":"1878228.00","current":"","total":"1878228.00"},"distance":"12.6 km","duration":"25 mins","coordinates":"-7.76306949999999900000,110.36527960000001000000"},{"name":"Sahid Raya  Yogyakarta","room_available":"2","rating":"4","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/1\/3\/business-13-07-2012-10-58-09.sq2.jpg","max_occupancies":"2","address":"JL Babarsari 2, Mantrijeron, Yogyakarta","regional":"  - Mantrijeron - Daerah Istimewa Yogyakarta","facilities":["Air conditioning","Internet - Wifi (complimentary)","Satellite\/cable TV","Desk","Shower","Bathtub","Mini bar","Coffee\/tea maker","Complimentary bottled water","Television"],"price":{"old":"1739100.00","current":"","total":"1739100.00"},"distance":"4.2 km","duration":"9 mins","coordinates":"-7.77693555685768900000,110.41656547144157000000"},{"name":"Savita Inn Garden Hotel &amp; Resto","room_available":"1","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/2\/4\/business-245376851.sq2.jpg","max_occupancies":"4","address":"Palagan Tentara Pelajar km.9 Street, Yogyakarta","regional":"  -   - Daerah Istimewa Yogyakarta","facilities":["Non Smoking room subject to availability","Air conditioning","Television LCD\/plasma screen","Satellite\/cable TV","Shower","Complimentary bottled water","Television","Slipper","Mirror","Hair dryer on request","Coffee and Tea Maker on request","Hot and Cold Shower"],"price":{"old":"1516669.00","current":"","total":"1516669.00"},"distance":"17.2 km","duration":"33 mins","coordinates":"-7.69774380000000000000,110.38769520000005000000"},{"name":"Fortune Fest Hotel Yogyakarta","room_available":"88","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/i\/m\/business-img_9741.sq2.jpg","max_occupancies":"2","address":"Jl. Raya Seturan , Depok, Sleman","regional":"  - Sleman - Daerah Istimewa Yogyakarta","facilities":["Non Smoking room subject to availability","Air conditioning","Television LCD\/plasma screen","Satellite\/cable TV","Shower","Hair dryer","Television","Slipper","Mirror","Hot and Cold Shower"],"price":{"old":"2329003.00","current":"517000.00","total":"517000.00"},"distance":"6.7 km","duration":"13 mins","coordinates":"-7.76833719999999900000,110.40990299999999000000"}],"rec_hotel":{"name":"Grand Zuri Malioboro Yogyakarta","room_available":"6","rating":"3","image":"https:\/\/www-sandbox.tiket.com\/img\/business\/g\/r\/business-grandzurimalioboro_building_13294.sq2.jpg","max_occupancies":"2","address":"Jln. Mangkubumi no 18, Malioboro , Danurejan, Yogyakarta","regional":"Danurejan - Danurejan - Daerah Istimewa Yogyakarta","facilities":["Non Smoking room subject to availability","In room safe","Air conditioning","Satellite\/cable TV","Desk","Shower","Mini bar","Coffee\/tea maker","Complimentary bottled water","Slipper","Mirror","Refrigerator","Free Toiletries","Cupboard","Hot and Cold Shower","Electronic\/magnetic Keys ","Free Wired High-speed Internet ","Climate Control ","Direct-dial Phone ","Minibar ","LCD TV "],"price":{"old":"1108155.00","current":"589558.00","total":"589558.00"},"distance":"8.4 km","duration":"22 mins","coordinates":"-7.78865048375879600000,110.36666017753305000000"}}}';
    // $scope.hw.data = JSON.parse(hoteldata);
    // console.log(JSON.parse(hoteldata));
    // $scope.hw.show = true;
    // $scope.hw.done = true;
    // var response = {'response' : []};
    // $scope.fw.data = response;
    // var venueData = '{"request":{"coordinates":"-7.79059704097567700000,109.37"},"response":{"venues":[{"name":"Angkringan Gareng Petruk","address":"Jalan Mangkubumi (Depan Kedaulatan Rakyat)","distance":547,"latitude":-7.7856883693513,"longitude":110.36682871079,"category":"Food Truck","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/food\/streetfood_44.png"},{"name":"Kawasan Wisata Angkringan (Kopi Joss)","address":"Jl. Wongsodirjan (Jalan Pangeran Mangkubumi)","distance":235,"latitude":-7.7888840974276,"longitude":110.36521124051,"category":"Food Truck","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/food\/streetfood_44.png"},{"name":"Puro Pakualaman","address":"Jalan Sultan Agung (Pakualaman)","distance":1517,"latitude":-7.8002682273407,"longitude":110.37616252899,"category":"Castle","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/parks_outdoors\/beach_44.png"},{"name":"OXEN FREE","address":"Jalan Sosrowijayan No. 2 (Malioboro)","distance":157,"latitude":-7.7915944129342,"longitude":110.3654551506,"category":"Bar","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/nightlife\/pub_44.png"},{"name":"Bladok Losmen&Restoran","address":"Jl. Sosrowijayan","distance":425,"latitude":-7.791476,"longitude":110.36271,"category":"Indonesian Restaurant","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/food\/indonesian_44.png"},{"name":"Warung Kopi Semesta","address":"Jalan Abu Bakar Ali No. 2 (Kotabaru)","distance":391,"latitude":-7.7897181218208,"longitude":110.3699065671,"category":"Coffee Shop","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/food\/coffeeshop_44.png"},{"name":"Hamzah Batik (mirota batik) Pusat Batik dan Kerajinan","address":"Jl. Jend. Ahmad Yani 9 Malioboro","distance":830,"latitude":-7.7979718628901,"longitude":110.36535669635,"category":"Arts & Crafts Store","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/shops\/artstore_44.png"},{"name":"Jogja National Museum","address":"Jalan Amri Yahya No. 1 (Gampingan, Wirobrajan)","distance":1814,"latitude":-7.800459559455,"longitude":110.3533744812,"category":"Art Gallery","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/arts_entertainment\/artgallery_44.png"},{"name":"LuCifer Bar & Resto","address":"Jl. Sosrowijayan No.17","distance":527,"latitude":-7.7916199217658,"longitude":110.36180176253,"category":"Bar","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/nightlife\/pub_44.png"},{"name":"Angkringan Kopi Jos Lek Man","address":"Lor Stasiun Tugu (Jalan Wongsodirjan)","distance":194,"latitude":-7.7889338438128,"longitude":110.3659327017,"category":"Coffee Shop","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/food\/coffeeshop_44.png"},{"name":"Alun - Alun Lor","address":"Jalan Alun - Alun Utara","distance":1506,"latitude":-7.8039885583111,"longitude":110.36448955536,"category":"Plaza","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/parks_outdoors\/plaza_44.png"},{"name":"Angkringan Kopi Joss Pak Agus","address":"Jalan Pangeran Mangkubumi (Jl. Pangeran Mangkubumi)","distance":381,"latitude":-7.78955337337,"longitude":110.36317486128,"category":"Food Truck","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/food\/streetfood_44.png"},{"name":"Lesehan Terang Bulan","address":"Jalan Jenderal Ahmad Yani 105 (Malioboro)","distance":679,"latitude":-7.7966329005404,"longitude":110.36556243896,"category":"Asian Restaurant","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/food\/asian_44.png"},{"name":"Loko Cafe - Experience The Heritage","address":"Stasiun Tugu","distance":363,"latitude":-7.7892017393864,"longitude":110.3634890452,"category":"Coffee Shop","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/food\/coffeeshop_44.png"},{"name":"Malioboro Mall","address":"Jl. Malioboro","distance":256,"latitude":-7.7928954816436,"longitude":110.36634579669,"category":"Mall","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/shops\/mall_44.png"},{"name":"Kali Code","address":"Yogyakarta","distance":1120,"latitude":-7.7814959957941,"longitude":110.37079811096,"category":"River","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/parks_outdoors\/river_44.png"},{"name":"Alun - Alun Kidul","address":"Jalan Alun - Alun Selatan","distance":2399,"latitude":-7.8118968089934,"longitude":110.36310553551,"category":"Plaza","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/parks_outdoors\/plaza_44.png"},{"name":"Ringin Kembar (Twin Banyan Tree)","address":"Alun Alun Kidul (Jalan Alun - Alun Selatan)","distance":2392,"latitude":-7.811833033377,"longitude":110.36310553551,"category":"Tree","icon":"https:\/\/ss3.4sqi.net\/img\/categories_v2\/parks_outdoors\/default_44.png"}]}}';
    // $scope.vw.data = JSON.parse(venueData);

    $scope.$on('start', function(event) {

        $scope.budget = {};
        $scope.fw = {}; // flight-widget
        $scope.hw = {}; // hotel-widget
        $scope.rw = {}; // route-widget
        $scope.vw = {}; // venue-widget

        $scope.budget.show = false;
        $scope.fw.show = false;
        $scope.hw.show = false;
        $scope.rw.show = false;
        $scope.vw.show = false;

        $scope.fw.done = false;
        $scope.hw.done = false;
        $scope.rw.done = false;
        $scope.vw.done = false;

        $scope.fw.data = {};
        $scope.hw.data = {};
        $scope.rw.data = {};
        $scope.vw.data = {};

        var airportCoordinates = {};
        var hotelCoordinates = {};

        $scope.budget.show = true;
        $scope.budget.value = 0;
        $scope.fw.show = true;
        $scope.hw.show = true;
    });

    $scope.$on('flightDone', function(event, flights) {
        $scope.fw.done = true;
        $scope.fw.data = flights.data;
        if (flights.data.response.length !== 0) {
            var departFare = parseFloat(flights.data.response.rec_flight.departure.price.total);
            var returnFare = flights.data.response.rec_flight.return.length !== 0 ? parseFloat(flights.data.response.rec_flight.return.price.total) : 0;
            $scope.budget.value += (departFare + returnFare);
        }
    });

    $scope.$on('hotelDone', function(event, hotels) {
         $scope.hw.done = true;
         $scope.hw.data = hotels.data;
         if (hotels.data.response.length !== 0) {
            $scope.budget.value += parseFloat(hotels.data.response.rec_hotel.price.total);
            airportCoordinates = hotels.data.request.airportCoordinates;
            hotelCoordinates   = hotels.data.response.rec_hotel.coordinates;
         }
    });

    $scope.$watchGroup(['fw.done', 'hw.done'], function(newValues, oldValues, scope) {
        if (newValues[0] === true && newValues[1] === true) {
            $scope.rw.show = true;
            $scope.rw.data = {'airportCoordinates' : airportCoordinates, 'hotelCoordinates' : hotelCoordinates}

            $scope.vw.show = true;
            Venues(hotelCoordinates).then(function(response) {
                $scope.vw.done = true;
                $scope.vw.data = response.data;
            });
        }
    });
}]);